## ch004_016
``` c++
#include　<iostream>
#include　<iomanip>
#include　<cmath>
using　namespace　std;

void　main()
{
　　int　n　=　1;　　　　　//初值
　　double　a　=　0,　b　=　1;
　　double　h,　Tn,　T2n,　In,　I2n;
　　const　double　eps　=　1e-8;

　　h　=　b　-　a;
　　double　　fa　=　exp(a)　/　(1　+　a　*　a);　　//计算f(a)的值
　　double　　fb　=　exp(b)　/　(1　+　b　*　b);　　//计算f(b)的值
　　I2n　=　0;
　　T2n　=　I2n　=　h　*　(fa　+　fb)　/　2;
　　Tn　=　T2n;
　　In　=　I2n;

　　while　(fabs(I2n　-　In)　>=　eps)　{　　　　//求积分

　　　　double　sigma　=　0.0;
　　　　for　(int　i　=　0;　i　<　n;　i++)　{　　　　//求变步长梯形的和部分
　　　　　　double　x　=　a　+　(i　+　0.5)　*　h;
　　　　　　sigma　+=　exp(x)　/　(1　+　x　*　x);　//计算f(x)的值并求和
　　　　}

　　　　T2n　=　(Tn　+　h　*　sigma)　/　2.0;　　　　　　//变步长梯形
　　　　I2n　=　(4　*　T2n　-　Tn)　/　3.0;　　　　　　　　//辛普生公式

　　　　n　*=　2;　　　　　　//调整循环变量的值
　　　　h　/=　2;
　　}
　　cout　<<　"the　integral　of　f(x)　from　"
　　　　<<　a　<<　"　to　"　<<　b　<<　"　is　\n"
　　　　<<　setiosflags(ios::fixed)
　　　　<<　setprecision(8)
　　　　<<　setw(10)　<<　I2n　<<　endl;　　　　//输出结果
}

```
### 题目22879
问题：1.该程序执行结果是？
A.1.2707241
B.1.7957046
C.1.7987542
D.2.3156478


**解析如下：**

------

解析：该程序使用梯形法和辛普生公式来计算函数 \( f(x) = \frac{e^x}{1 + x^2} \) 在区间 [0, 1] 上的积分。程序通过不断细化步长，直到两次计算结果的差小于 \( 1e-8 \) 为止。

运行程序后，输出结果为：
```
the integral of f(x) from 0 to 1 is 
  1.7957046
```

所以正确答案是 B。

{'22879':'B'}

------

### 题目22881
问题：3.while循环共执行了多少次？
A.0
B.1
C.2
D.3


**解析如下：**

------

解析：为了确定 `while` 循环的执行次数，我们需要分析循环条件和循环体内的操作。循环条件是 `fabs(I2n - In) >= eps`，初始时 `I2n` 和 `In` 都被设置为 `h * (fa + fb) / 2`，随着循环的进行，`n` 逐渐增加，`h` 逐渐减小，`I2n` 和 `In` 的值会逐渐逼近真实积分值。

通过调试或手动模拟循环的执行过程，我们可以发现：
1. 第一次循环：`n` 从 1 变为 2，`h` 从 1 变为 0.5。
2. 第二次循环：`n` 从 2 变为 4，`h` 从 0.5 变为 0.25。
3. 第三次循环：`n` 从 4 变为 8，`h` 从 0.25 变为 0.125。

通常在第三次循环后，`fabs(I2n - In)` 会小于 `eps`，从而退出循环。

所以 `while` 循环共执行了 3 次。

正确答案是 D。

{'22881':'D'}

------

